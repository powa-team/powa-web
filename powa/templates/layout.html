<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{{ title }}</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="{{ static_url('img/favicon/favicon.ico') }}">
    <link rel="shortcut icon" href="{{static_url('img/favicon/favicon.ico') }}" type="image/x-icon" />
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-TileImage" content="{{ static_url('img/favicon/mstile-144x144.png') }}">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    {% block header %} {% end %}
  </head>
  <body>
    <div id="app">
      <v-app>
        <v-app-bar
          app
          elevation="2"
          height="40px;"
        >
          <v-btn href="{{ reverse_url('Overview')}}" class="mr-2">
            <img src="{{ static_url('img/favicon/favicon-32x32.png')}}"/>&nbsp;PoWA
          </v-btn>
          {% if current_user %}
          <v-toolbar-title
            text
            class="mr-2"
          >
            Server <b>{{ handler.current_server }}</b>
            ({{ handler.current_connection }})
          </v-toolbar-title>
          <v-btn text color="primary"
            href="{{ reverse_url('RepositoryConfigOverview')}}"
            title="Configuration"
          >
            <v-icon left>
              {{! icons.mdiCog  }}
            </v-icon>
            Configuration
          </v-btn>
          <v-btn text color="primary" id="reload_collector">
            <v-icon left>
              {{! icons.mdiReload  }}
            </v-icon>
            Reload collector
          </v-btn>

          <v-spacer></v-spacer>

          <v-btn text color="primary"
            href="{{ reverse_url('logout') }}"
            >
            <v-icon left>
              {{! icons.mdiPower  }}
            </v-icon>
            Logout
          </v-btn>
          {% end %}
          {% if current_user %}
          <template v-slot:extension>
            <v-breadcrumbs :items="breadCrumbItems">
              <template v-slot:item="{ item }">
                <v-breadcrumbs-item
                  :href="item.href"
                  :disabled="item.disabled"
                >
                  <template v-if="item.text != 'Home'">
                    {{! item.text }}
                  </template>
                  <template v-else>
                    <v-icon color="primary" small>{{! icons.mdiHome }}</v-icon>
                  </template>
                </v-breadcrumbs-item>
              </template>
            </v-breadcrumbs>
            <v-spacer></v-spacer>
            <date-range-picker ml-auto></date-range-picker>
          </template>
          {% end %}
        </v-app-bar>
        <v-main class="grey lighten-3">
          <v-container fluid>
            <v-row>
              <v-col>
                {% block content %} {% end %}
              </v-col>
            </v-row>
          </v-container>
          <v-container fluid id="messages">
            {% module Messages() %}
          </v-container>
        </v-main>
        <v-footer>
          <v-container fluid>
            <v-row>
              <v-flex>
                <ul style="margin-bottom: 0; padding-left: 0;">
                  <li style="display: inline-block">Version {{version()}}</li>
                  <li style="display: inline-block">&copy; 2014-2017 Dalibo</li>
                  <li style="display: inline-block">&copy; 2018-{{year()}} The PoWA-team</li>
                  <li style="display: inline-block"><a href="https://powa.readthedocs.io">https://powa.readthedocs.io</a></li>
                </ul>
              </v-flex>
              <v-flex ml-auto class="text-right">
                <a href="https://github.com/powa-team/powa-web/issues">Report a bug</a>
              </v-flex>
            </v-row>
          </v-container>
        </v-footer>
      </v-app>
    </div>
    {% if current_user %}
<script type="text/breadcrumb">
  {%
    raw to_json([{
      "text": "Home",
      "href": reverse_url('Overview'),
      "disabled": False
    }] + [{
      "text": item.title,
      "href": reverse_url_with_params(item.url_name, url_args=item.url_params.values()),
      "disabled": i == len(handler.breadcrumb) - 1
    } for i, item in enumerate(reversed(handler.breadcrumb))])
  %}
</script>
    {% end %}
    {% if handler.application.settings['debug'] %}
      <!-- FIXME -->
      <script type="module" src="http://localhost:5173/powa/static/js/main.js"></script>
    {% else %}
      {% raw inject_assets("powa/static/js/main.js") %}
    {% end %}
  </body>
</html>
